#include "http.hpp"
#include <string>
#include <iostream>

int main(int argc, char **argv)
{
  HTTPConnection con ;

  /*
  std::string host = "api.openweathermap.org" ;
  std::string locationid = "3333178" ; // Nottingham
  std::string key = "266ac02a47670517a130450d4dba1418" ;
  std::string urn = "/data/2.5/forecast?id=" + locationid + "&APPID=" + key + "&mode=json";
  */

  std::string host = "192.168.1.111" ;
  std::string urn = "/" ;

  if (argc > 1){
    urn = argv[1] ;
  }
    
  con.set_urn(urn) ;
  if (!con.send_get(host, 80)){
    std::cout << "Cannot process the GET data\n" ;
  }

  std::string str = con.get_data() ;
  
  std::cout << "Return code: " << con.get_http_code() << std::endl;
  std::cout << "<<DATA>>\n" << str << "<<DATA>>\n" ;

  return 0 ;  
}
